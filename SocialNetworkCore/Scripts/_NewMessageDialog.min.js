$(function () {
    $('div#new_msg_dlg a.okey').live("click", function () {
        $(this).parents().eq(1).submit();
    });
});

function hide_dialog() {
    HideDialog();
}

function SendNewMessageBegin() {
    $('div#dialog div#dialog_msg').hide();
}

function SendNewMessageFailure() {
    show_error_dialog('fail');
    $('div#dialog div#dialog_msg').removeClass('success_message').addClass('error_message').html($('input#w_ajax_fail').val()).fadeIn('fast');
}

function SendNewMessageSuccess(data) {
    if (data.Done) {
        var msgText = "";
        var msgs = data.Messages;
        for (var i = 0; i < msgs.length; i++) {
            msgText +=
                "<span class='" + (msgs[i].SendingResult ? "suc" : "err") + "'>" + msgs[i].FullName + ": " + msgs[i].Message + "</span>" +
                (i < msgs.length - 1 ? "<br />" : "");
        }
        $('div#dialog div#dialog_msg').attr('class', 'scrollable_dlg_msg').html(msgText).fadeIn('fast');
    }
    else {
        $('div#dialog div#dialog_msg').removeClass('success_message').addClass('error_message').html(data.Errors[0]).fadeIn('fast');
    }
}